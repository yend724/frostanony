# Frostanony - 顔画像自動匿名化ツール

プライバシーを守る顔画像自動匿名化アプリケーション

## 概要

Frostanonyは、画像内の顔を自動検出し、ぼかしやモザイクエフェクトを適用することで個人のプライバシーを保護するWebアプリケーションです。すべての処理はブラウザ内で完結し、画像データが外部に送信されることはありません。

## 主な機能

- 🔍 **自動顔検出**: TensorFlow.js + MediaPipeを使用した高精度な顔検出（最大10人対応）
- 👥 **複数人対応**: 集合写真や複数人が写る画像に完全対応
- 🎯 **視覚的確認**: 検出された顔を赤枠で表示、番号付きで識別
- 🌫️ **ぼかしエフェクト**: 自然な見た目のぼかし処理
- 🧩 **モザイクエフェクト**: ピクセル化による匿名化
- ⚙️ **強度調整**: 5段階のエフェクト強度調整（弱・やや弱・中・やや強・強）
- 🔄 **リアルタイム再適用**: エフェクト変更時の即座な再処理
- 📋 **スクロール対応**: 大きな画像でもスクロールで全体確認可能
- 📱 **レスポンシブ対応**: モバイル・タブレット・デスクトップ対応
- 🔒 **プライバシー保護**: ブラウザ内完結、外部送信なし
- 💾 **簡単ダウンロード**: 処理済み画像のワンクリックダウンロード

## 技術スタック

- **フレームワーク**: Next.js 15 (App Router)
- **言語**: TypeScript
- **スタイリング**: Tailwind CSS + Tailwind Variants
- **機械学習**: TensorFlow.js + MediaPipe Face Detection
- **テスト**: Vitest（純粋関数のユニットテスト）
- **開発**: ESLint + Prettier

## 対応形式

- **入力形式**: JPEG, PNG, WebP
- **最大ファイルサイズ**: 10MB
- **出力形式**: 元の画像形式を維持

## 開発環境のセットアップ

### 前提条件

- Node.js 18以上
- npm または pnpm

### インストール

```bash
# リポジトリをクローン
git clone [repository-url]
cd frostanony

# 依存関係をインストール
npm install

# 開発サーバーを起動
npm run dev
```

### 利用可能なコマンド

```bash
# 開発サーバー起動
npm run dev

# 本番用ビルド
npm run build

# 本番サーバー起動
npm start

# テスト実行
npm run test

# テストUI起動
npm run test:ui

# 型チェック
npm run type-check

# リント実行
npm run lint
```

## 使い方

1. **画像をアップロード**
   - ドラッグ&ドロップまたはファイル選択で画像をアップロード
   - 自動的に顔検出が開始されます

2. **顔検出結果を確認**
   - 検出された顔が赤枠で囲まれて表示されます
   - 各顔に番号が振られて識別されます
   - 大きな画像はスクロールで全体を確認できます

3. **エフェクトを選択・調整**
   - ぼかし または モザイク を選択
   - スライダーで強度を調整（5段階：弱〜強）
   - 既に適用済みの場合は、変更時に自動で再適用されます

4. **適用ボタンをクリック**
   - 検出された全ての顔にエフェクトを適用

5. **結果確認・ダウンロード**
   - 処理済み画像をプレビューで確認
   - 「画像をダウンロード」ボタンでPNG形式でダウンロード

## セキュリティとプライバシー

- ✅ すべての処理はブラウザ内で実行
- ✅ 画像データの外部送信なし
- ✅ 処理後の自動メモリクリア
- ✅ HTTPS環境での動作推奨

## ブラウザ対応

- Chrome 90以上
- Firefox 88以上
- Safari 14以上
- Edge 90以上

## 開発ガイド

### プロジェクト構造

Feature-Sliced Design (FSD) アーキテクチャを採用:

```
src/
├── app/                 # Next.js App Router設定
├── views/               # ページレベルのコンポーネント
│   └── home/           # ホームページ
├── features/            # ビジネス機能の実装
│   ├── image-upload/   # 画像アップロード機能
│   ├── face-detection/ # 顔検出機能
│   ├── image-effects/  # エフェクト処理機能
│   └── image-processing/ # 画像処理パイプライン
├── entities/            # ビジネスエンティティ
│   ├── face/           # 顔検出エンティティ
│   └── image/          # 画像エンティティ
├── shared/              # 共通のユーティリティとコンポーネント
│   ├── ui/             # UIコンポーネント
│   ├── lib/            # ユーティリティ関数
│   ├── config/         # 設定ファイル
│   └── test/           # テスト設定
└── docs/                # プロジェクトドキュメント
```

### 主要コンポーネント

- **FaceDetectionCanvas**: 顔検出結果の視覚的表示
- **EffectControls**: エフェクト選択・強度調整UI
- **ImageUpload**: ドラッグ&ドロップ対応の画像アップロード
- **useImageProcessor**: 画像処理パイプライン管理フック
- **useFaceDetection**: 顔検出機能管理フック

### テスト

純粋関数のユニットテストのみ実装されています：

```bash
# 全テスト実行（ウォッチモード）
npm run test

# テスト結果を一度だけ実行
npm run test:run

# ブラウザでテストUI表示
npm run test:ui
```

**テスト方針**: 
- UIコンポーネントやReactフックのテストは不要
- 純粋関数のロジックのみテスト対象
- DOM依存やブラウザAPI依存のテストは除外

### コーディング規約

- TypeScript strict mode
- ESLint + Prettier による自動フォーマット
- 関数型プログラミングスタイル
- Feature-Sliced Design (FSD) アーキテクチャ
- 純粋関数の単体テスト重視

## ライセンス

MIT License

## 貢献

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## サポート

バグ報告や機能要求は、[Issues](issues)でお知らせください。